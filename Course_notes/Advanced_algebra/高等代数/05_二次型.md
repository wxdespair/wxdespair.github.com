## 5 二次型

### 5.0 二次型及其矩阵表示

设 $P$ 是一数域，一个系数在数据 $P$ 中的 $x_1, x_2, \dots , x_n$ 的二次齐次多项式
$$
f(x_1, x_2, \dots , x_n) = a_{11}x_1^2 + 2a_{12}x_1x_2 + \dots + 
2a_{1n}x_1x_n + a_{22}x_2^2 + \dots + 2a_{2n}x_2x_n + \dots + a_{nn}x_n^2 \tag{1}
$$
称为**数域** $P$ **上的一个** $n$ **元二次型**，或者，在不致引起混淆时简称**二次型**。

例如 $x_1^2 + x_1x_2 + 3x_1x_3 + 2x_2^2 + 4x_2x_3 + 3x_3^2$ 就是有理数域上的一个三元二次型。为了方便讨论，一般将 $x_ix_j(i<j)$ 的系数写成 $2a_{ij}$ ，而不简单地写成 $a_{ij}$ 。

在处理许多问题时，常常希望通过变量的线性替换来简化有关的二次型。为此，引入：

> **定义1：**	设 $x_1, x_2, \dots , x_n;y_1, y_2, \dots , y_n$ 是两组文字，系数在数域 $P$ 中的一组关系式：
> $$
> \left\{
> 	\begin{array}{}
> 		x_1 & = c_{11}y_1+c_{12}y_2 + \dots + c_{1n}y_n ~ ,\\
> 		x_2 & = c_{21}y_1+c_{22}y_2 + \dots + c_{2n}y_n ~ ,\\
> 		~ &\dots \dots \\
> 		x_n & = c_{n1}y_1+c_{n2}y_2 + \dots + c_{nn}y_n ~ 
> 	\end{array}
> \right. \tag{2}
> $$
> 称为由 $x_1, x_2, \dots , x_n$ 到 $y_1, y_2, \dots , y_n$ 的一个**线性替换**，或简称线性替换。如果系数行列式
> $$
> \left|
> \begin{matrix}
> c_{11}&c_{12}&\dots&c_{1n}\\
> c_{21}&c_{22}&\dots&c_{2n}\\
> \vdots&\vdots&&\vdots\\
> c_{n1}&c_{n2}&\dots&c_{nn}
> \end{matrix}
> \right| \neq 0~,
> $$
> 那么线性替换 $(2)$ 就称为**非退化的**。

线性替换把二次型变成二次型。

将 $2a_{ij}$ 分开书写，可得：
$$
\begin{align}
f(x_1,x_2,\dots,x_n) =
& a_{11}x_1^2 + a_{12}x_1x_2 + \dots + a_{1n}x_1x_n\\
&+ a_{21}x_2x_1 + a_{22}x_2^2 + \dots + a_{2n}x_2x_n\\
& ~~ \dots ~~ \dots\\
& + a_{n1}x_nx_1 + a_{n2}x_nx_2 + \dots + a_{nn}x_n^2\\
= & \sum^n_{i=1} \sum^n_{j=1} a_{ij}x_ix_j ~ . \tag{3} 
\end{align}
$$
将 $(3)$ 中的系数排成一个 $n \times n$ 矩阵
$$
A = 
\left[
\begin{matrix}
a_{11}&a_{12}&\dots&a_{1n}\\
a_{21}&a_{22}&\dots&a_{2n}\\
\vdots&\vdots&&\vdots\\
a_{n1}&a_{n2}&\dots&a_{nn}
\end{matrix}
\right], \tag{4}
$$
$(4)$ 就称为**二次型 $(3)$ 的矩阵**。

易知 $A=A^T$ ，即二次型的矩阵都是对称的。

令
$$
X = 
\left[\begin{matrix}
x_1 \\
x_2 \\
\vdots\\
x_n
\end{matrix}\right]
$$
于是，二次型可以用矩阵的乘积表示为
$$
\begin{align}
X^TAX & = [x_1, x_2, \dots , x_n]
\left[\begin{matrix}
a_{11}&a_{12}&\dots&a_{1n}\\
a_{21}&a_{22}&\dots&a_{2n}\\
\vdots&\vdots&&\vdots\\
a_{n1}&a_{n2}&\dots&a_{nn}
\end{matrix}\right]
\left[\begin{matrix}
x_1 \\ x_2 \\ \vdots \\ x_n
\end{matrix}\right] \\
& = [x_1, x_2, \dots , x_n]
\left[\begin{matrix}
a_{11}x_1 + a_{12}x_2 + \dots + a_{1n}x_n\\
a_{21}x_1 + a_{22}x_2 + \dots + a_{2n}x_n\\
\vdots \\
a_{n1}x_1 + a_{n2}x_2 + \dots + a_{nn}x_n\\
\end{matrix}\right] \\
& = \sum^n_{i=1} \sum^n_{j=1} a_{ij}x_ix_j ~ .
\end{align}
$$
故
$$
f(x_1,x_2,\dots,x_n) = X^TAX ~ .\tag{5}
$$
二次型和它的矩阵是相互唯一决定的。



若二次型 $f(x_1,x_2,\dots,x_n) = X^TAX = X^TBX$ ，且 $A^T = A,B^T = B$，则 $A=B$ 。



令
$$
C = 
\left[\begin{matrix}
c_{11}&c_{12}&\dots&c_{1n}\\
c_{21}&c_{22}&\dots&c_{2n}\\
\vdots&\vdots&&\vdots\\
c_{n1}&c_{n2}&\dots&c_{nn}
\end{matrix}\right]~,
~Y =\left[\begin{matrix}y_1 \\ y_2 \\ \vdots \\y_n\end{matrix}\right] ~ .
$$
于是线性替换 $(2)$ 可以写成
$$
\left[\begin{matrix}
x_1 \\ x_2 \\ \vdots\\ x_n
\end{matrix}\right] = 
\left[\begin{matrix}
c_{11}&c_{12}&\dots&c_{1n}\\
c_{21}&c_{22}&\dots&c_{2n}\\
\vdots&\vdots&&\vdots\\
c_{n1}&c_{n2}&\dots&c_{nn}
\end{matrix}\right]
\left[\begin{matrix}y_1 \\ y_2 \\ \vdots \\y_n\end{matrix}\right]~，
$$
或者
$$
X = CY ~ . \tag{6}
$$


$(5)$与$(6)$相结合就能得到$X^TAX = (CY)^TA(CY) = Y^TC^TACY = Y^T(C^TAC)Y=Y^TBY$ ，即也有$B=C^TAC$。

> **定义2：**	数据 $P$ 上的 $n \times n$ 矩阵 $A,B$ 称为合同的，如果有数域 $P$ 上的可逆 $n \times n$ 矩阵 $C$ ，使
> $$
> B = C^TAC ~ .
> $$

由矩阵 $A$ 到矩阵 $C^TAC$ 的变换称为矩阵的一个**合同变换**。

合同是矩阵之间的一个关系，不难看出，合同关系具有如下性质：

1. 自反性：$A = E^TAE$ ；

2. 对称性：由 $B = C^TAC$ 即得 $A=(C^{-1})^TBC^{-1}$ ；

3. 传递性：由 $A_1 = C_1^TAC_1$ 和 $A_2 = C_2^TA_1C_2$ 即得
   $$
   A_2 = (C_1C_2)^TA(C_1C_2) ~ .
   $$

经过非退化线性替换，新二次型的矩阵与原二次型的矩阵是合同的。

在变换二次型时，要求所作的线性替换是非退化的，当线性替换 $X=CY$ 是非退化时，$Y = C^{-1}X$ 也是一个线性替换。后者把所得的二次型还原，这样就使得可以从所得二次型的性质可以推知原来二次型的一些性质。

### 5.1 标准型

二次型中最简单的一种就是只包含平方项的二次型 $d_1x_1^2 + d_2x_2^2 + \dots + d_nx_n^2$ 。

> **定理1：**	数域 $P$ 上任意一个二次型都可以经过非退化的线性替换变成只包含平方和项的形式。

> **定理2：**	在数域 $P$ 上，任意一个对称矩阵都合同于一对角矩阵。

就是说对于任意一个对称矩阵 $A$ ，都可以找到一个可逆矩阵 $C$ ，使 $C^TAC$ 是对角矩阵。

二次型 $f(x_1,x_2,\dots,x_n)$ 经过非退化线性替换所变成的平方和称为 $f(x_1,x_2,\dots,x_n)$ 的一个**标准型**。

#### 任意二次型转化为标准型的方法

………………

### 5.2 唯一性

在一个二次型的标准形中，系数不为零的平方项的个数是唯一确定的，与所作的非退化线性替换无关。二次型矩阵的秩有时就称为二次型的秩。但标准形中的系数，就不一定是唯一的了。

例如，二次型 $2x_1x_2 + 2x_1x_3 -6x_2x_3$ 经过线性替换
$$
\left[\begin{matrix}
x_1 \\ x_2 \\ x_3
\end{matrix}\right] = 
\left[\begin{matrix}
1 & 1 & 3 \\ 
1 & -1 & -1 \\ 
0 & 0 & 1
\end{matrix}\right]
\left[\begin{matrix}
y_1 \\ y_2 \\ y_3
\end{matrix}\right]
$$
得到标准形 $2y_1^2 - 2y_2^2 + 6y_3^2$ ，而经过线性替换
$$
\left[\begin{matrix}
x_1 \\ x_2 \\ x_3
\end{matrix}\right] = 
\left[\begin{matrix}
1 & -\frac{1}{2} & 1 \\ 
1 & \frac{1}{2} & -\frac{1}{3} \\ 
0 & 0 & \frac{1}{3}
\end{matrix}\right]
\left[\begin{matrix}
w_1 \\ w_2 \\ w_3
\end{matrix}\right]
$$
就得到另一个标准形 $2w_1^2 - \frac{1}{2}x_2^2 + \frac{2}{3}w_3^2$ 。这说明，在一般的数域内，二次型的标准形不是唯一的，而与所作的非退化线性替换有关。

#### 5.2.0 复数域

设 $f(x_1,x_2,\dots,x_n)$ 是一复数域上的二次型（简称复二次型）。经过一适当的非退化线性替换后，变成标准形。假定它的标准形是
$$
d_1y_1^2+ d_2y_2^2+ \dots + d_ny_n^2,~~d_i\neq0~,~~i=1, 2, \dots, r ~. \tag{7}
$$
其中 $r$ 是 $f(x_1,x_2,\dots,x_n)$ 的矩阵的秩。在复数域中，复数总可以开平方，所以可以再作一非线性替换
$$
\left\{
\begin{array}{}
y_1 & = \frac{1}{\sqrt{d_1}}z_1~,\\
& \dots\dots \\
y_r & = \frac{1}{\sqrt{d_r}}z_r~,\\
y_{r+1} & = z_{r+1}~,\\
& \dots\dots \\
y_n & = z_n~.
\end{array}
\right. \tag{8}
$$
就可以得到 
$$
z_1^2 + z_2^2 + \dots + z_r^2 \tag{9}
$$
$(9)$ 称为复二次型 $(7)$ 的**规范形**。显然，规范形完全被二次型矩阵的秩 $r$ 所决定。所以可以得到下面的定理。

> **定理3：**	任意一个复二次型，经过一适当的非退化线性替换可以变成规范形，并且规范形是唯一的。

定理3 换个说法就是说，任一复对称矩阵合同于一个形为
$$
\left[\begin{matrix}
1 & & & & &\\
  & \ddots & & & &\\
  & & 1 & & & \\
  & &   & 0 & &  \\
  & &   &   & \ddots & \\
  & &   &   & & 0
\end{matrix}\right]
$$
的对角矩阵，从而有两个复对称矩阵合同的充要条件是它们的秩相等。

#### 5.2.1 实数域

设 $f(x_1,x_2,\dots,x_n)$ 是一实数域上的二次型（简称实二次型）。经过一适当的非退化线性替换，再适当排列文字的次序，可使实二次型变成标准形。假定它的标准形是
$$
d_1y_1^2 + \dots + d_py_p^2 -d_{p+1}y_{p+1}^2- \dots d_ty_t^2,~~d_i > 0~,~~i=1, 2, \dots, r ~. \tag{10}
$$
其中 $r$ 是 $f(x_1,x_2,\dots,x_n)$ 的矩阵的秩。在实数域中，正实数可以开平方，所以可以再作一非线性替换
$$
\left\{
\begin{array}{}
y_1 & = \frac{1}{\sqrt{d_1}}z_1~,\\
& \dots\dots \\
y_r & = \frac{1}{\sqrt{d_r}}z_r~,\\
y_{r+1} & = z_{r+1}~,\\
& \dots\dots \\
y_n & = z_n~.
\end{array}
\right. \tag{11}
$$
就可以得到 
$$
z_1^2 + \dots + z_p^2 - z_{p+1}^2 - \dots - z_r^2 \tag{12}
$$
$(12)$ 称为复二次型 $(10)$ 的**规范形**。显然，规范形完全 $r,p$ 这两个数所决定。所以可以得到下面的定理。

> **定理4：**	任意一个实二次型，经过一适当的非退化线性替换可以变成规范形，并且规范形是唯一的。

上述定理通常被称为**惯性定理**。

> **定义3：**	在实二次型 $f(x_1,x_2,\dots,x_n)$ 的规范形中，正平方项的个数 $p$ 称为 $f(x_1,x_2,\dots,x_n)$ 的**正惯性指数**；负平方项的个数 $r-p$ 称为 $f(x_1,x_2,\dots,x_n)$ 的**负惯性指数**；它们的差 $p-(r-p)=2p-r$ 称为 $f(x_1,x_2,\dots,x_n)$ 的**符号差**。

虽然实二次型的标准形不是唯一的，但是由上面化成规范形的过程可以看出，标准形中系数为正的平方项的个数与规范形中正平方项的个数是唯一确定的。所以惯性定理也可以叙述为：实二次型的标准形中系数为正的平方项的个数是唯一确定的，它等于正惯性指数，而系数为负的平方项的个数就等于负惯性指数。

对于矩阵，有类似 定理2 的结论：

> **定理5：**	
>
> 1. 任一复对称矩阵 $A$ 都合同于一个下述形式的对角矩阵：
>    $$
>    \left[\begin{matrix}
>    1 & & & & &\\
>      & \ddots & & & &\\
>      & & 1 & & & \\
>      & &   & 0 & &  \\
>      & &   &   & \ddots & \\
>      & &   &   & & 0
>    \end{matrix}\right]
>    $$
>    其中对角线上 1 的个数 $r$ 等于 $A$ 的秩；
>
> 2. 任一实对称矩阵 $A$ 都合同于一个下述形式的对角矩阵：
>    $$
>    \left[\begin{matrix}
>    1 &        &   &   & 		& & && \\
>      & \ddots &   &   & 		& & && \\
>      & 	   & 1 &   &  	 	& & && \\
>    & & & -1&        &   &   & 		&\\
>    & & &   & \ddots &   &   & 		&\\
>    & & &   & 	   &-1 &   &  	 	& \\
>    & & &   & 	   &   & 0 &        &  \\
>    & & &   & 	   &   &   & \ddots & \\
>    & & &   & 	   &   &   & 		& 0
>    \end{matrix}\right],
>    $$
>    其中对角线上 1 的个数 $p$ 及 -1 的个数 $r-p(r是A的秩)$ 都是唯一确定的，分别称为 $A$ 的**正、负惯性指数**，它们的差 $2p-r$ 称为 $A$ 的**符号差**。

### 5.3 正定二次型

> **定义4：**	实二次型 $f(x_1,x_2,\dots,x_n)$ 称为**正定的**，如果对于任意一组不全为零的实数 $c_1,c_2,\dots,c_n$ ，都有$f(c_1,c_2,\dots,c_n)>0$ 。

非退化实线性替换可以保持正定性不变，有如下定理：

> **定理6：**	$n$ 元实二次型 $f(x_1,x_2,\dots,x_n)$ 是正定的充要条件是它的正惯性指数等于 $n$ 。

定理6 说明，正定二次型 $f(x_1,x_2,\dots,x_n)$ 的规范形为 
$$
y_1^2,y_2^2,\dots,y_n^2 ~. \tag{13}
$$

> **定义5：**	实对称矩阵 $A$ 称为正定的，如果二次型 $X^TAX$ 正定。

因为二次型 $(13)$ 的矩阵是单位矩阵 $E$ ，所以一个实对称矩阵是正定的当且仅当它与单位矩阵合同。由此得：

> **推论：**	正定矩阵的行列式大于零。



> **定义6：**	子式
> $$
> H_i = 
> \left|\begin{matrix}
> a_{11} & a_{12} & \dots & a_{1i} \\
> a_{21} & a_{22} & \dots & a_{2i} \\
> \vdots & \vdots & & \vdots \\
> a_{i1} & a_{i2} & \dots & a_{ii} 
> \end{matrix}\right|,~~i=1, 2, \dots,n
> $$
> 称为矩阵 $A=(a_{ij})_{n \times n}$ 的**顺序主子式**。

> **定理7：**	实二次型
> $$
> f(x_1,x_2,\dots,x_n) = 
> \sum^n_{i=1} \sum^n_{j=1} a_{ij}x_ix_j = X^TAX
> $$
> 是正定的充要条件为矩阵 $A$ 的顺序主子式全大于零。

与正定性平行，还有下面的概念。

> **定义7：**	设 $f(x_1,x_2,\dots,x_n)$ 是一实二次型，对于任意一组不全为零的实数 $c_1,c_2,\dots,c_n$，
>
> * 如果都有 $f(c_1,c_2,\dots,c_n)<0$，那么 $f(x_1,x_2,\dots,x_n)$ 称为负定的；
> * 如果都有 $f(c_1,c_2,\dots,c_n) \geqslant 0$，那么 $f(x_1,x_2,\dots,x_n)$ 称为半正定的；
> * 如果都有 $f(c_1,c_2,\dots,c_n) \leqslant 0$，那么 $f(x_1,x_2,\dots,x_n)$ 称为半负定的；
> * 如果它既不是半正定又不是半负定，那么 $f(x_1,x_2,\dots,x_n)$ 称为不定的；

对于半正定性，我们有：

> **定理8：**	对于实二次型 $f(x_1,\dots,x_n)=X^TAX$ ，其中 $A$ 是实对称的，下列条件等价：
>
> 1. $f(x_1,\dots,x_n)$ 是半正定的；
>
> 2. 它的正惯性指数与秩相当；
>
> 3. 有实可逆矩阵 $C$ ，使 
>    $$
>    C^TAC = 
>    \left[\begin{matrix}
>    d_1 &  &  &  \\
>     & d_2 &  &  \\
>     &  & \ddots &  \\
>     &  &  & d_n 
>    \end{matrix}\right],
>    $$
>    其中 $d_i \geqslant 0(i=1, 2, \dots, n)$ ；
>
> 4.  有实矩阵 $C$ ，使 $A=C^TC$ ；
>
> 5.  $A$ 的所有主子式(行指标与列指标相同的子式)皆大于或等于零

在 定理8 的第 5 点中，仅有顺序主子式大于或等于零是不能保证半正定性的，比如 
$$
f(x_1,x_2)=-x_2^2 = [x_1,x_2]\left[\begin{matrix}0&0\\0&-1\end{matrix}\right]\left[\begin{matrix}x_1\\x_2\end{matrix}\right]
$$
